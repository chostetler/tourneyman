{% extends "base.html" %}

{% block title %} Matches {% endblock %}

{% block content %}

<a href="?format=timeslot" class="btn btn-primary m-1"> Group by start time </a>  
<a href="?format=room" class="btn btn-primary m-1"> Group by room </a>
<hr>

{% if user.is_staff %}
<a href="{% url 'match_create' %}" class="btn btn-success"> Add match </a>
{% endif %}

{% if request.GET.format == 'bracket'%}
    {% regroup incomplete_matches by bracket as round_list %}
    {% regroup complete_matches by bracket as round_list_c %}
{% elif request.GET.format == 'room' %}
    {% regroup incomplete_matches by room as round_list %}
    {% regroup complete_matches by room as round_list_c %}
{% else %}
    {% regroup incomplete_matches by timeslot as round_list %}
    {% regroup complete_matches by timeslot as round_list_c %}
{% endif %}


<h3> Upcoming Matches </h3>
{% if incomplete_matches %}
{% for round in round_list %}
    <h4> {{round.grouper}} </h4>
    <div class="list-group" style="margin: 10px">
        {% for match in round.list %}
            {% include "scorebug-skinny.html" %}
        {% endfor %}
    </div>
{%endfor%}
{% endif %}

<h3> Completed Matches </h3>
{% if complete_matches %}
{% for round in round_list_c %}
    <h4> {{round.grouper}} </h4>
    <div class="row gap-1">
        {% for match in round.list %}
        <div class="col-auto mx-auto d-md-none" style="min-width: 20rem">
            {% include "scorebug-result-two-rows.html" %}
        </div>
        <div class="col d-none d-md-block">
            <div class="row" style="min-width: 40rem">
                {% include "scorebug-result-one-row.html" %}
            </div>
        </div>

        {% endfor %}
    </div>
{%endfor%}
{% endif %}

{% endblock %}
